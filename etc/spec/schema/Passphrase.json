{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://kuaplan.de/meta/schema/NewPassphrase.json",
    "title": "Authentication Passphrase",
    "description": "Configuration of a Passphrase (authentication token), granting a specific access role to users which provide it",
    "type": "object",

    "properties": {
        "id": {
            "description": "The unique id of the passphrase. Must be omitted when creating a new passphrase. Otherwise, it's always present.",
            "type": "integer"
        },
        "passphrase": {
            "description": "The actual passphrase to be entered by the user for authentication. When receiving existing passphrases from the server, parts of the string may be replaced with DEL (0x7f) characters. If this passphrase is only activatable by deriving deriving from another passphrase, this property is omitted.",
            "type": "string",
            "nullable": true
        },
        "derivableFromPassphrase": {
            "description": "If present, the passphrase can be derived from the other passphrase with this id, i.e. a user being authenticated with the other passphrase can get the role granted by this passphrase without actually entering this passphrase.",
            "type": "integer",
            "nullable": true
        },
        "role": {
            "description": "The access role granted by activating this passphrase. Corresponds to the roles shown in Authorization Information.",
            "type": "string",
            "enum": ["participant", "orga", "admin", "participant-sharable"]
        }
    },
    "required": ["passphrase", "derivableFromPassphrase" ,"role"]
}

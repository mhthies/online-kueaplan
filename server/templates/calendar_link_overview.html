{% extends "base.html" %}

{% block body %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h1>{{ base.page_title }}</h1>
            {% if shareable_session_token.is_some() %}
                <div class="mb-3">
                    <label for="caldavLink">iCal-Link</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="caldavLink" readonly value="{{ ical_link()? }}">
                        <button type="button" class="btn btn-outline-secondary copy-button">
                            <i class="bi bi-copy" aria-hidden="true"></i> kopieren
                            <div class="d-none text-success" style="width: 100%; height: 100%"><i class="bi bi-check"></i></div>
                        </button>
                    </div>
                    <div class="form-text">
                        <i class="bi bi-info-circle" aria-hidden="true"></i> FÃ¼r Kalender-Programme und Kalender-Apps
                    </div>
                </div>
            {% else %}
                TODO
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    for (const button of document.getElementsByClassName("copy-button")) {
        button.addEventListener("click", (e) => copyInputText(e.target));
    }

    async function copyInputText(button) {
        const input = button.parentElement.getElementsByTagName("input")[0];
        try {
            await navigator.clipboard.writeText(input.value);
        } catch (error) {
            console.error(error.message);
        }
    }
</script>
{% endblock %}
